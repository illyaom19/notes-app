<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="theme-color" content="#1f6b8f" />
    <title>Notes App Prototype</title>
    <link rel="manifest" href="./manifest.webmanifest" />
    <link rel="icon" href="./icons/icon-192.png" type="image/png" />
    <link rel="icon" href="./icons/icon-192.svg" type="image/svg+xml" />
    <link rel="apple-touch-icon" href="./icons/icon-192.png" />
    <link rel="stylesheet" href="./src/styles/app.css" />
  </head>
  <body>
    <main class="app-shell">
      <header class="topbar" data-production-hidden="true">
        <h1>Notes App Prototype</h1>
      </header>

      <section class="section-strip" aria-label="Notebook Sections">
        <label id="context-picker-pill" class="context-pick" for="context-select">
          <span>Notebook</span>
          <select id="context-select" aria-label="Active notebook"></select>
        </label>
        <div id="section-tabs" class="section-tabs" role="tablist" aria-label="Sections"></div>
        <button id="new-context" type="button">New Notebook</button>
        <button id="new-section" type="button">New Section</button>
        <button id="undo-ink" type="button" disabled>Undo</button>
        <button id="redo-ink" type="button" disabled>Redo</button>
        <button id="toggle-search-panel" type="button">Search</button>
        <button id="toggle-tools" type="button" class="tools-toggle">Menu</button>
      </section>

      <section id="controls-panel" class="controls-panel" hidden>
        <div class="controls" aria-label="Settings and Actions">
          <button id="toggle-ui-mode" type="button">Mode: Production</button>
          <button id="enable-ink" type="button">Enable Ink</button>
          <button id="toggle-ink-tool" type="button" disabled>Ink Tool: Pen</button>
          <button id="import-context-widget" type="button">Import Widgets</button>
          <button id="start-worker" type="button" data-production-hidden="true">Start Worker</button>
          <label class="toggle-control" for="gesture-enabled">
            <input id="gesture-enabled" type="checkbox" checked />
            <span>Gestures Enabled</span>
          </label>
          <label class="toggle-control" for="gesture-doubletap-enabled">
            <input id="gesture-doubletap-enabled" type="checkbox" />
            <span>Double Tap</span>
          </label>
          <label class="toggle-control" for="gesture-barreltap-enabled">
            <input id="gesture-barreltap-enabled" type="checkbox" checked />
            <span>Barrel Tap</span>
          </label>
          <label class="select-control" for="gesture-doubletap-binding">
            <span>Double Tap Binding</span>
            <select id="gesture-doubletap-binding">
              <option value="none">None</option>
              <option value="toggle-ink-tool">Toggle Ink Tool</option>
              <option value="toggle-ink-enabled">Toggle Ink Enabled</option>
              <option value="toggle-search-panel">Toggle Search Panel</option>
            </select>
          </label>
          <label class="select-control" for="gesture-barreltap-binding">
            <span>Barrel Tap Binding</span>
            <select id="gesture-barreltap-binding">
              <option value="toggle-ink-tool">Toggle Ink Tool</option>
              <option value="toggle-ink-enabled">Toggle Ink Enabled</option>
              <option value="toggle-search-panel">Toggle Search Panel</option>
              <option value="none">None</option>
            </select>
          </label>
          <button id="toggle-onboarding-hints" type="button">Disable Hints</button>
          <button id="reset-onboarding-hints" type="button" data-production-hidden="true">Reset Hints</button>
        </div>
      </section>

      <section class="status-panel" aria-label="App Status">
        <span><strong>Mode:</strong> <output id="ui-mode-state">production</output></span>
        <span><strong>Notebook:</strong> <output id="active-context">none</output></span>
        <span><strong>Section:</strong> <output id="active-section">none</output></span>
        <span><strong>Documents:</strong> <output id="document-count">0</output></span>
        <span><strong>Loaded Modules:</strong> <output id="loaded-modules">none</output></span>
        <span><strong>Widgets:</strong> <output id="widget-count">0</output></span>
        <span><strong>Reference Popups:</strong> <output id="reference-count">0</output></span>
        <span><strong>Snip:</strong> <output id="snip-state">idle</output></span>
        <span><strong>Whitespace:</strong> <output id="whitespace-state">idle</output></span>
        <span><strong>Peek:</strong> <output id="peek-state">off</output></span>
        <span><strong>Whitespace Zones:</strong> <output id="whitespace-zone-count">0</output></span>
        <span><strong>Ink:</strong> <output id="ink-state">idle</output></span>
        <span><strong>Ink Tool:</strong> <output id="ink-tool">pen</output></span>
        <span><strong>Strokes:</strong> <output id="stroke-count">0</output></span>
        <span><strong>Gestures:</strong> <output id="gesture-state">off</output></span>
        <span><strong>Search Index:</strong> <output id="search-index-count">0</output></span>
        <span><strong>Worker:</strong> <output id="worker-state">idle</output></span>
        <span><strong>Camera:</strong> <output id="camera-state">x=0, y=0, zoom=1.00</output></span>
      </section>

      <aside id="search-panel" class="search-panel" aria-label="Search Panel" hidden>
        <div class="search-panel-header">
          <h2>Search Widgets</h2>
          <button id="search-close" type="button">Close</button>
        </div>
        <label class="search-query" for="search-query">
          <span>Query</span>
          <input id="search-query" type="search" placeholder="Search titles, notes, citations, and document text..." />
        </label>
        <p id="search-status" class="search-status">Type a query to search indexed widget text.</p>
        <div class="search-actions">
          <button id="search-prev" type="button">Prev</button>
          <button id="search-next" type="button">Next</button>
          <output id="search-result-count">0 results</output>
        </div>
        <div id="search-results" class="search-results" role="listbox" aria-label="Search results"></div>
      </aside>

      <aside id="suggestion-rail" class="suggestion-rail" aria-label="Widget Suggestions" hidden></aside>
      <aside id="snip-mode-notifier" class="snip-mode-notifier" aria-live="polite" hidden>
        <span id="snip-mode-label">Snip mode active</span>
        <button id="snip-exit" type="button">Exit snip mode</button>
      </aside>
      <aside id="section-minimap" class="section-minimap" aria-label="Section minimap" aria-hidden="true" hidden>
        <canvas id="section-minimap-canvas" aria-hidden="true"></canvas>
      </aside>

      <section class="canvas-wrap">
        <canvas id="workspace-canvas" aria-label="Workspace Canvas"></canvas>
        <section id="reference-preview-layer" class="reference-preview-layer" aria-label="Reference previews"></section>
      </section>

      <button id="reference-manager-launcher" class="reference-manager-launcher" type="button" aria-label="Open Library">
        <span class="library-fab-icon" aria-hidden="true">
          <span class="library-fab-book library-fab-book--left"></span>
          <span class="library-fab-book library-fab-book--middle"></span>
          <span class="library-fab-book library-fab-book--right"></span>
        </span>
      </button>

      <section id="reference-manager-overlay" class="reference-manager-overlay" hidden aria-hidden="true">
        <div id="reference-manager-panel" class="reference-manager-panel" role="dialog" aria-label="Notebook library">
          <p class="library-chip-section-title">All Library Items:</p>
          <div id="reference-manager-reference-list" class="library-chip-stack" aria-label="All library entries"></div>
          <div class="library-chip-divider" aria-hidden="true"></div>
          <p class="library-chip-section-title">Recently used</p>
          <div id="reference-manager-note-list" class="library-chip-stack" aria-label="Recently used entries"></div>
          <div id="reference-manager-document-list" hidden></div>
          <div hidden>
            <button id="reference-manager-close" type="button">Close</button>
            <button id="reference-manager-tab-references" type="button">References</button>
            <button id="reference-manager-tab-notes" type="button">Notes</button>
            <button id="reference-manager-tab-documents" type="button">Documents</button>
            <output id="reference-manager-reference-count">0 references</output>
            <output id="reference-manager-note-count">0 notes</output>
            <output id="reference-manager-document-count">0 documents</output>
          </div>
        </div>
      </section>

      <aside id="onboarding-hint" class="onboarding-hint" hidden>
        <p id="onboarding-hint-progress" class="onboarding-hint-progress">Hint 1 of 3</p>
        <h2 id="onboarding-hint-title">Get started</h2>
        <p id="onboarding-hint-body">Hints appear here.</p>
        <div class="onboarding-hint-actions">
          <button id="onboarding-hint-action" type="button">Try It</button>
          <button id="onboarding-hint-dismiss" type="button">Dismiss</button>
          <button id="onboarding-hint-toggle" type="button">Disable Hints</button>
          <button id="onboarding-hint-reset" type="button">Reset</button>
        </div>
      </aside>

      <menu id="widget-context-menu" class="widget-menu" aria-label="Widget actions">
        <button type="button" data-action="copy-widget">Copy</button>
        <button type="button" data-action="rename-widget">Rename</button>
        <button type="button" data-action="toggle-library">Add To Library</button>
        <button type="button" data-action="toggle-pin">Pin</button>
        <button type="button" data-action="widget-info">Info</button>
        <button type="button" data-action="remove-widget">Delete</button>
      </menu>

      <menu id="creation-command-menu" class="creation-menu" aria-label="Creation Menu">
        <button type="button" data-create-type="expanded-area">Notes</button>
        <button type="button" data-create-type="snip">Snip</button>
        <button type="button" data-create-type="pdf-document">PDF Document</button>
      </menu>
    </main>

    <input id="pdf-file-input" type="file" accept="application/pdf" hidden />

    <script type="module" src="./src/main.js"></script>
  </body>
</html>
